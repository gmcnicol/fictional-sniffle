# 023 — Content Extraction Pipeline (Readability + Sanitize)

**Goal:** Best-effort full content extraction with safe HTML and main image heuristic fallback.

## Deliverables

- Worker that uses `@mozilla/readability` + `linkedom` to parse HTML off-thread.
- Sanitize all returned HTML with DOMPurify (strict profile, no inline event handlers).
- Heuristic image selection: enclosure > first IMG in content:encoded/summary > `og:image` from fetched HTML.
- Clear “Open Original” CTA when blocked by CORS.

## Tests

- Unit: sanitize removes scripts/event handlers; heuristic picks expected image for known samples.
- E2E: For a CORS-allowed sample, cleaned article renders; for blocked sample, CTA appears.

## CI Gates

- Security: no unsanitized HTML paths (tests assert sanitizer usage).
- Lighthouse: no significant CLS from content insertion.

## Acceptance Criteria

- No XSS vectors with provided fixtures.
- Clean HTML displays without style leakage.
- All CI checks pass.
