# 022 â€” Alt Text Extraction & Domain Rules (xkcd, SMBC)

**Goal:** Ensure reliable alt/caption for popular comics and correct main image selection.

## Deliverables

- `src/lib/rules.json` with domain rules for:
  - `xkcd.com`: select `#comic img`, caption from `title` attribute.
  - `www.smbc-comics.com`: select main comic image (known container), alt from `title` or nearby caption element.
- `src/lib/rules.ts` applying domain rules before heuristics.
- Fixtures: saved HTML samples for xkcd + SMBC.
- Unit tests covering extraction correctness.

## Tests

- Unit: Given fixtures, rules return correct `imageUrl` + `caption`.
- E2E: Navigating to test articles results in correct image+caption in Reader.

## CI Gates

- 90%+ coverage on `rules.ts`.
- All other CI gates intact.

## Acceptance Criteria

- xkcd and SMBC render correct image and caption every run.
- With RSS lacking enclosures, rules still succeed when CORS fetch is available.
- All CI checks pass.
